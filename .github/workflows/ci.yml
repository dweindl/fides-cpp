name: Run tests
on: [push, pull_request, workflow_dispatch]

jobs:
  build:
    name: Tests Ubuntu
    runs-on: ubuntu-20.04

    steps:
    - name: apt
      run: |
        sudo apt-get update \
          && sudo apt-get install -y \
            cmake \
            g++ \
            libatlas-base-dev \
            libspdlog-dev

    - name: Checkout
      uses: actions/checkout@25a956c84d5dd820d28caab9f86b8d183aeeff3d


    - name: Build
      run: |
        cmake -Wdev -Werror=dev -Wdeprecated -Werror=deprecated \
            -S . -B build/ \
          && cmake --build build/ -j 2

    - name: Tests
      run: CTEST_OUTPUT_ON_FAILURE=1 ctest
